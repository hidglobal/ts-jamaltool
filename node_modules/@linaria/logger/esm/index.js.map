{"version":3,"file":"index.js","names":["genericDebug","pc","levels","currentLevel","indexOf","process","env","LINARIA_LOG","linariaLogger","loggers","Map","gerOrCreate","namespace","lastIndexOf","has","set","substr","extend","get","formatters","r","ref","color","parseInt","colorCode","text","f","fn","JSON","stringify","format","replace","log","level","namespaces","template","restArgs","logger","enabled","debug","bind","info","warn","error","notify","message","console","red","s","italic","substring","length","padStart","num","len","toString","createCustomDebug","name","id","_args","arg1","args"],"sources":["../src/index.ts"],"sourcesContent":["import genericDebug from 'debug';\nimport type { Debugger } from 'debug';\nimport pc from 'picocolors';\n\ntype LogLevel = 'error' | 'warn' | 'info' | 'debug';\n\nconst levels = ['error', 'warn', 'info', 'debug'];\nconst currentLevel = levels.indexOf(process.env.LINARIA_LOG || 'warn');\n\nconst linariaLogger = genericDebug('linaria');\n\nconst loggers = new Map<string, Debugger>();\n\nfunction gerOrCreate(namespace: string | null | undefined): Debugger {\n  if (!namespace) return linariaLogger;\n  const lastIndexOf = namespace.lastIndexOf(':');\n  if (!loggers.has(namespace)) {\n    loggers.set(\n      namespace,\n      gerOrCreate(namespace.substr(0, lastIndexOf)).extend(\n        namespace.substr(lastIndexOf + 1)\n      )\n    );\n  }\n\n  return loggers.get(namespace)!;\n}\n\ngenericDebug.formatters.r = (ref: { namespace: string; text?: string }) => {\n  const color = parseInt(gerOrCreate(ref.namespace).color, 10);\n  const colorCode = `\\u001B[3${color < 8 ? color : `8;5;${color}`}`;\n  const text = ref.text ?? ref.namespace;\n  return `${colorCode};1m${text}\\u001B[0m`;\n};\n\ngenericDebug.formatters.f = function f(fn: () => unknown) {\n  return JSON.stringify(fn());\n};\n\nconst format = <T>(text: T) => {\n  if (typeof text === 'string') {\n    return text.replace(/\\n/g, '\\n\\t');\n  }\n\n  return text;\n};\n\nfunction log(\n  level: LogLevel,\n  namespaces: string,\n  template: unknown | (() => void),\n  ...restArgs: unknown[]\n) {\n  if (currentLevel < levels.indexOf(level)) {\n    return;\n  }\n\n  const logger = gerOrCreate(namespaces);\n  if (!logger.enabled) return;\n\n  if (typeof template === 'function') {\n    const text = template();\n    if (text) {\n      logger(format(text), ...restArgs);\n    }\n    return;\n  }\n\n  logger(format(template), ...restArgs);\n}\n\nexport const debug = log.bind(null, 'debug');\nexport const info = log.bind(null, 'info');\nexport const warn = log.bind(null, 'warn');\nexport const error = log.bind(null, 'error');\n\nexport const notify = (message: string) => {\n  // eslint-disable-next-line no-console\n  console.log(\n    pc.red(\n      message.replace(/(`.*?`)/g, (s) =>\n        pc.italic(s.substring(1, s.length - 1))\n      )\n    )\n  );\n};\n\nconst padStart = (num: number, len: number) =>\n  num.toString(10).padStart(len, '0');\n\nexport type CustomDebug = (\n  namespace: string,\n  template: string,\n  ...args: unknown[]\n) => void;\n\nexport function createCustomDebug(name: string, id: number): CustomDebug {\n  return (..._args: Parameters<typeof debug>) => {\n    const [namespace, arg1, ...args] = _args;\n    debug(`${name}:${padStart(id, 5)}`, `[${namespace}] ${arg1}`, ...args);\n  };\n}\n"],"mappings":"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"}